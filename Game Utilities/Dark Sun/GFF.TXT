Файл ресурсов .GFF игр DARK SUN 1 и 2 состоит из заголовка, тела и директории,
за которой иногда может следовать некоторый объем неиспользуемых данных.
Заголовок файла устроен так:
+00 DB 'GFFI' (сигнатура)
+04 DW 0,3
+08 DD 1Ch (размер заголовка)
+0C DD смещение директории в файле
+10 DD размер директории
+14 DD 0
+18 DD неизвестно что
+1C ... тело файла
Директория состоит из заголовка, набора теговых блоков и концевика.
Она устроена так:
+0 DD 8
+4 DD размер директории-2 байта (размер без концевика)
+8 DW число тегов в директории
+A ... теговые блоки
+? DW 0 (концевик)
Теговые блоки по структуре разделяются на два типа. Блоки первого типа
устроены так:
+00 DB*4 тег (имя типа блока)
+04 DD число элементов в блоке
+08 DD уникальный (не повторяющийся для этого тега в этом файле) номер ресурса
       для 1-го элемента
+0C DD смещение ресурса в файле для 1-го элемента
+10 DD размер ресурса для 1-го элемента
+14 ... (так же для остальных элементов)
Блоки второго типа устроены так:
+00 DB*4 тег
+04 DD число _ресурсов_ в блоке OR 80000000h
+08 DD число _ресурсов_ в блоке
+0C DD уникальный номер таблицы ресурсов для этого блока
+10 DD число _элементов_ в блоке
+14 DD базовый уникальный номер ресурса для 1-го элемента
+18 DD число нумеруемых подряд ресурсов для 1-го элемента
+1C ... (так же для остальных элементов)
Таблицы ресурсов, на которые ссылаются блоки второго типа, сами являются
ресурсами блоков с тегом 'GFFI' (первого типа, естественно). Они устроены так:
+00 DD число ресурсов в таблице
+04 DD смещение в файле 1-го ресурса
+08 DD размер 1-го ресурса
+0C ... (так же для остальных ресурсов)

Ресурсы можно разделить на графические, звуковые, текстовые и прочие. Тип
ресурса определяется тегом его блока.
К графическим ресурсам относятся теги:
'BMP ', 'WALL', 'PORT', 'ICON', 'CMAT', 'TILE', 'CBMP': в DARK SUN 1 это файлы
 того же формата, что и файлы .BMP игры EYE OF THE BEHOLDER 3; в DARK SUN 2
 в большинстве случаев используется сжатая версия этого формата
'BMA': крупные блоки анимации - несколько соединенных вместе таких .BMP-файлов,
       все фазы которых выводятся как единая последовательность без очистки
       (т.е. каждая последующая фаза поверх всех предыдущих)
'FONT': файлы того же формата, что и файлы .FNT игры EYE OF THE BEHOLDER 3
'PAL ', 'CPAL': файлы палитры; какая палитра нужна для графического ресурса
       (если не любая подходит), обычно можно догадаться по его номеру
'ACF ': файлы управления анимацией, также способные менять палитру
К звуковым ресурсам относятся теги:
'BVOC': обычные VOC-файлы
'PSEQ', 'CSEQ', 'LSEQ', 'GSEQ', 'FSEQ': XMI-файлы
К текстовым ресурсам относятся теги:
'TEXT', 'MERR', 'ETME', 'NAME', 'SPIN', 'RNME'
Из прочих ресурсов следует отметить тег 'GPL ', видимо, содержащий сценарий;
к сожалению, ресурсы этого типа сложным образом сжаты либо зашифрованы, а
особого желания с ними разбираться у меня не возникло.

Файлы управления анимацией (тег 'ACF ') присутствуют только в DARK SUN 1, так
же как и сами анимационные файлы (тег 'BMA '). Они состоят из блоков-команд.
Команды устроены так:
+0 DB длина команды (всегда четная)
+1 DB байт команды
+2 ... данные команды (при длине >2)
К установке палитры относятся команды 00h, 14h и 15h.
Команда 00h - закончить обработку файла - устроена так:
+0 DB 2
+1 DB 0
Команда 14h - задать цвет в палитре - устроена так:
+0 DB 6
+1 DB 14h
+2 DB R-компонент
+3 DB номер цвета
+4 DB B-компонент
+5 DB G-компонент
Команда 15h - установить собранную (командами 14h) палитру - устроена так:
+0 DB 2
+1 DB 15h

Вот, собственно, и все...