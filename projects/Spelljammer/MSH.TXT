Файл графики .MSH игры SPELLJAMMER состоит из заголовка и тела. Заголовок файла
устроен так:
+0 DW размер-9 для сжатого файла, 0 для несжатого
+2 DW 0
+4 DW ширина картинки
+6 DW высота картинки
+8 DB флаги: бит 0=1 - цвет 1-го пиксела в картинке считается прозрачным (?)
             бит 3=1 - тело файла сжато
+9 ... тело файла

В несжатом виде тело файла представляет собой простой битмап, расположенный по
строкам.
Тело сжатого файла сжато совершенно уникальным способом - неадаптивным методом
Хаффмена поверх RLE-метода. При этом оно устроено так:
+0 DW распакованный размер тела файла
+2 DW 0
+4 DW число узлов дерева кодов Хаффмена(=N)
+6 DW*N*2 собственно узлы дерева кодов (>=0 - номер следующего узла, <0 - конец
      цепочки: NOT сам кодированный символ)
+? DB*? сами сжатые данные

Реализация метода Хаффмена вполне тривиальная; код 100h используется как код
конца информации и должен присутствовать в конце любого сжатого блока; выборка
кодов идет с младших битов и с младших адресов, распаковка производится до тех
пор, пока не встретится код конца информации, либо будут исчерпаны входные
данные.
Описывать здесь сам метод Хаффмена я счел неуместным - так что RTFM; а детали
реализации распаковщика желающие могут получить, изучив его исходный текст.

То, что получается при распаковке, кроме того, дополнительно сжато RLE-методом:
90h XXh - (XXh-1) раз повторить последний не равный 90h байт; 90h 00h - выдать
90h; иначе просто выдать байт в выходное изображение.

Только и всего...